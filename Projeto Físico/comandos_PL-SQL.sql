-- ANUNCIO_DE_MATRIZ VERIFICA SE EXISTE ALGUMA EMPRESA MATRIZ (EMPRESA SEM MATRIZ ASSOCIADA A ELA) COM ANUNCIO DE ID IGUAL A ID_CHECK, PRINTANDO SE EXISTE OU NAO

CREATE OR REPLACE PROCEDURE ANUNCIO_DE_MATRIZ (ID_CHECK NUMBER) IS 
	TEST VARCHAR(4);
BEGIN

    SELECT COUNT(*)
    INTO TEST
    FROM MARKETING
    WHERE CIPJMARK IN (
        SELECT CIPJMARK
        FROM ANUNCIO
        WHERE ID = ID_CHECK)
    AND CIPJMATRIZ IS NULL;
   
    IF TEST = 0 THEN
        DBMS_OUTPUT.PUT_LINE('NENHUMA EMPRESA MATRIZ POSSUI ANUNCIO COM ID '||ID_CHECK);
    ELSE
        DBMS_OUTPUT.PUT_LINE('EXISTE EMPRESA MATRIZ COM ANUNCIO DE ID '||ID_CHECK);
    END IF;

END;

-- RANK_DA_TRANSP CLASSIFICA AS TRANSPORTADORAS EM BRONZE, SILVER OU GOLD DE ACORDO COM O NUMERO DE MOTORISTAS
-- GOLD TEM 10 OU MAIS, PRATA TEM ENTRE 5 E 10, BRONZE TEM MENOS DE 5
-- TAMBEM PRINTA O CIPJ (DADO NO ARGUMENTO) E O NUMERO DE MOTORISTAS

CREATE OR REPLACE PROCEDURE RANK_DA_TRANSP (CIPJ_TEST VARCHAR) IS
    NUM NUMBER;
BEGIN

    SELECT COUNT(*)
    INTO NUM
    FROM CAMINHAOMOTORISTA
    WHERE CIPJTRANS = CIPJ_TEST;

    IF NUM >= 10 THEN
        DBMS_OUTPUT.PUT_LINE('EMPRESA DE CIPJ '||CIPJ_TEST||' TEM '||NUM||' MOTORISTAS, SENDO UMA TRANSPORTADORA GOLD');
    ELSIF NUM >= 5 THEN
        DBMS_OUTPUT.PUT_LINE('EMPRESA DE CIPJ '||CIPJ_TEST||' TEM '||NUM||' MOTORISTAS, SENDO UMA TRANSPORTADORA SILVER');
    ELSE
        DBMS_OUTPUT.PUT_LINE('EMPRESA DE CIPJ '||CIPJ_TEST||' TEM '||NUM||' MOTORISTAS, SENDO UMA TRANSPORTADORA BRONZE');
    END IF;

END;






